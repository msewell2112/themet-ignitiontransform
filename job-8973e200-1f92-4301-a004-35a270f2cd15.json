{
  "id" : "8973e200-1f92-4301-a004-35a270f2cd15",
  "name" : "MMS - APTOS to MMS daily sales file",
  "lastRun" : [ 2017, 5, 17, 19, 51, 5 ],
  "enabled" : true,
  "tasks" : [ {
    "id" : "9c4bc425-6f42-4792-8536-269072cec6fc",
    "ordinal" : 1,
    "taskParameters" : [ {
      "id" : "2916fe4b-51bd-4c25-bc09-82cc48664edb",
      "ordinal" : 1,
      "value" : "9793111d-d037-41d8-8729-59ff731da7d1",
      "desc" : "Node to target",
      "name" : "node",
      "valueType" : 3,
      "secret" : false,
      "refId" : "b0b883bb-8c3d-439d-ad3c-f09a4bfe11c3"
    }, {
      "id" : "e8cc846e-8264-4420-abb1-4c505a64fba9",
      "ordinal" : 2,
      "value" : "/home/ftpuser/transform/themet/input/^SalesOrdersCreated_.*.xml$",
      "desc" : "Url to file",
      "name" : "url",
      "valueType" : 0,
      "secret" : false,
      "refId" : "49bfed33-b7ba-4fff-800c-03492846fcba"
    }, {
      "id" : "93107650-5298-487f-92a0-401a1e0febd6",
      "ordinal" : 3,
      "value" : "",
      "desc" : "User to login to ftp",
      "name" : "user",
      "valueType" : 0,
      "secret" : false,
      "refId" : "a369a683-6183-4d0e-88e7-f39e79bbaca1"
    }, {
      "id" : "ed9586c1-ddf8-4ea3-b8ca-21fe92843cd3",
      "ordinal" : 4,
      "value" : "",
      "desc" : "Password to login to ftp",
      "name" : "password",
      "valueType" : 0,
      "secret" : true,
      "refId" : "d35b10ba-da27-436a-af85-1ecc45413347"
    }, {
      "id" : "92331aae-cc12-4988-95b8-31c9ac4a75ff",
      "ordinal" : 5,
      "value" : "OrderFile",
      "desc" : "Output Key",
      "name" : "outputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "958d3cc1-9f65-4a33-82f1-7b56f4fb0a97"
    } ],
    "job" : {
      "id" : "8973e200-1f92-4301-a004-35a270f2cd15",
      "name" : "MMS - APTOS to MMS daily sales file",
      "lastRun" : [ 2017, 5, 17, 19, 51, 5 ],
      "enabled" : true,
      "desc" : "MMS - APTOS to MMS daily sales file",
      "status" : "READY",
      "snsARN" : "arn:aws:sns:us-east-1:194810246581:THEMET_Job_8973e200-1f92-4301-a004-35a270f2cd15",
      "key" : "MET-00000001",
      "environment" : "STAGING"
    },
    "name" : "Remote file to map task",
    "key" : "Core::NodeFileToMapTask",
    "comment" : "Get file from node (production)",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.NodeFileToMapTask",
    "enabled" : false,
    "desc" : "Copy file from remote to map.",
    "refId" : "4c4b17e1-3904-473c-8784-0b53212ad251",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "117e44d7-741e-4174-acf6-d55ba1ec3662",
    "ordinal" : 2,
    "taskParameters" : [ {
      "id" : "ce7ec91f-35e1-4651-ab16-c94e77909bc5",
      "ordinal" : 1,
      "value" : "!{ftpuser}",
      "desc" : "User to login to ftp",
      "name" : "user",
      "valueType" : 0,
      "secret" : false,
      "refId" : "4f75fa01-c582-49aa-8f20-1b48462a8b28"
    }, {
      "id" : "a10ec0ee-fec0-48bd-aa57-ef43ffa70b69",
      "ordinal" : 2,
      "value" : "BXXINgqvppOr17T72uw7VQ==",
      "desc" : "Password to login to ftp",
      "name" : "password",
      "valueType" : 0,
      "secret" : true,
      "refId" : "48fbf631-e014-45ee-a8eb-298ac7d1fa21"
    }, {
      "id" : "88ebbadc-aac2-4b2f-b180-ec00e1cc59a5",
      "ordinal" : 3,
      "value" : "!{ftpurl}/input/SalesOrdersCreated.*.xml",
      "desc" : "Url to file",
      "name" : "url",
      "valueType" : 0,
      "secret" : false,
      "refId" : "45c250b3-72b5-4d81-a392-6ab7c6f5709d"
    }, {
      "id" : "4e6e19dd-ada1-494f-a56d-273f559a4d8f",
      "ordinal" : 4,
      "value" : "OrderFile",
      "desc" : "Key name of output file",
      "name" : "outputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "201b77ea-8e35-4c3c-9f45-dd8afc123e10"
    } ],
    "job" : {
      "id" : "8973e200-1f92-4301-a004-35a270f2cd15",
      "name" : "MMS - APTOS to MMS daily sales file",
      "lastRun" : [ 2017, 5, 17, 19, 51, 5 ],
      "enabled" : true,
      "desc" : "MMS - APTOS to MMS daily sales file",
      "status" : "READY",
      "snsARN" : "arn:aws:sns:us-east-1:194810246581:THEMET_Job_8973e200-1f92-4301-a004-35a270f2cd15",
      "key" : "MET-00000001",
      "environment" : "STAGING"
    },
    "name" : "Download File to Map Task",
    "key" : "Core::DownloadFileToMapTask",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.DownloadFileToMapTask",
    "enabled" : false,
    "desc" : "Task used to download a file from FTP,SFTP,FTPS,Local and S3.",
    "refId" : "84211b05-40ce-4939-874d-825b983c3bda",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "72ed4ede-dbdc-448b-8e46-3b30349f9740",
    "ordinal" : 3,
    "taskParameters" : [ {
      "id" : "2805dd86-bcdf-4c4c-a7d8-1db1843dd234",
      "ordinal" : 1,
      "value" : "OrderFile",
      "desc" : "Key name of input file\n",
      "name" : "inputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "33b71961-09fb-4f69-9df8-46721a14b8a4"
    }, {
      "id" : "e0b9e7ec-4749-4d3e-9f83-5f18f978c33f",
      "ordinal" : 2,
      "value" : "OrdersMap",
      "desc" : "Key name to hold return value in dictionary",
      "name" : "outputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "f1628808-0116-4d32-bff0-af0cb53d06b2"
    }, {
      "id" : "f7811cef-aa06-40be-a1a4-37b606f7e40f",
      "ordinal" : 4,
      "value" : "/Orders/Order",
      "desc" : "Node to Break the row on",
      "name" : "rowIndicator",
      "valueType" : 0,
      "secret" : false,
      "refId" : "be88cc2e-5ba9-4277-a484-1d8146b78565"
    } ],
    "job" : {
      "id" : "8973e200-1f92-4301-a004-35a270f2cd15",
      "name" : "MMS - APTOS to MMS daily sales file",
      "lastRun" : [ 2017, 5, 17, 19, 51, 5 ],
      "enabled" : true,
      "desc" : "MMS - APTOS to MMS daily sales file",
      "status" : "READY",
      "snsARN" : "arn:aws:sns:us-east-1:194810246581:THEMET_Job_8973e200-1f92-4301-a004-35a270f2cd15",
      "key" : "MET-00000001",
      "environment" : "STAGING"
    },
    "name" : "XML to Map Task",
    "key" : "Core::XmlToMapTask",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.XmlToMapTask",
    "enabled" : true,
    "desc" : "Task used to read xml file into the dictionary",
    "refId" : "4ca3d6e5-23fc-4d6a-beb2-09f0c9a5c2f3",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "559608d5-58af-46e2-a6cd-79a32cd6018f",
    "ordinal" : 4,
    "taskParameters" : [ {
      "id" : "28272a35-4b4b-4247-8a86-944e52c02f05",
      "ordinal" : 1,
      "value" : "/*\n * Takes an Orders hash generated from APTOS Order xml, executes\n * business rule against it so that it is in a format that \n * Freemarker can easily consume.  \n */\nvar inDebug = dict.inDebug; \nload('!{ThisHost}/js/global.js');\n\nvar creditReasonMap = { \"Customer Appeasement\": \"CA\", \"Postage Refund\": \"C \", \"Gift Wrap Refund\": \"GW\",\n                        \"Promo Discount Refund\": \"P\", \"Freight Credit\": \"F \", \"Member Discount\": \"MD\",\n                        \"Return Credit\": \"R \", \"Miscellaneous\": \"D \", \"Other\": \"D \"};\n\nvar root = new java.util.HashMap();\nvar orderIterator = ICT.MAP.ITERATOR('OrdersMap');\n\nvar invoices = new java.util.ArrayList();\nvar seq = 1;\nvar isReturn = false;\nvar fileName = dict.get('OrderFile_ORIG_FILE_NAME_');\nvar pos = fileName.indexOf('_');\nvar pos2 = fileName.indexOf('_', pos+1);\nvar shipDate = fileName.substring(pos+1, pos2);\nvar orderCredits;\n\ntry {\n    orderCredits = getOrderCredits(shipDate);\n} catch (err) {\n    var errMessage = 'An error occurred while trying to retrieve Order Credits from '+\n        'Aptos during MMS interface run.  Exception: ' + err;\n    \n    if (err instanceof java.io.IOException) {\n        ICT.TASK_ERROR('MMS -> Get Order Credits Timeout.', errMessage);\n    } else {\n        dict.put(ICT.NODE_NO_DELETE, true);\n        ICT.TASK_ERROR('MMS -> Get Order Credits Error.', errMessage);\n    }\n}\n\nwhile (orderIterator.hasNext()) {\n    var order = orderIterator.next();\n    var orderStatus = order.OrderStatusId;\n    // we have to check for list as it could be a list or an object\n    var itemList = ICT.LIST(order.OrderItems.Item);\n    if (itemList.size() === 0) continue;\n    var oiIter = itemList.iterator();\n    var invoiceItemTotal = 0;\n    var invoiceShippingTotal = 0;\n    var invoiceTaxTotal = 0;\n    var creditTotal = 0;\n    var writeShippingAndTotal = false;\n    var itemCacheMap = new java.util.HashMap();\n    while(oiIter.hasNext()) {\n        var orderItem = oiIter.next();\n        try {\n    \t    var itemStatus = orderItem.ItemStatusId;\n    \t    var shipDateFound = false;\n    \t    var itemShipDate = orderItem.ItemShipDate;\n    \t    var itemCache = {\n    \t\t  ItemId: orderItem.ItemID,\n    \t\t  ProductPartNo: orderItem.ItemProduct.ProductPartNo,\n    \t\t  Quantity: orderItem.ItemQuantity\n    \t    };\t\n    \t    itemCacheMap.put(orderItem.ItemID, itemCache);\n    \t    try {\n    \t        var parts = itemShipDate.split('T');\n    \t        itemShipDate = parts[0];\n    \t        itemShipDate = itemShipDate.replaceAll('\\\\-', '');\n    \t        shipDateFound = true;\n    \t    } catch (err) { }\n    \t    if (itemStatus == '4' || itemStatus == '23') {\n    \t        addItem(order, 'I', '99', orderItem.ItemProduct.ProductPartNo, orderItem.ItemQuantity,\n    \t            ICT.CUR(orderItem.ItemPrice),ICT.CUR(orderItem.ItemTax), false, itemStatus, '');  \n    \t    } else if (itemStatus == '17' && shipDateFound && itemShipDate.equalsIgnoreCase(shipDate)) {\n    \t        addItem(order, 'I', '01', orderItem.ItemProduct.ProductPartNo, orderItem.ItemQuantity,\n    \t        ICT.CUR(orderItem.ItemPrice), ICT.CUR(orderItem.ItemTax), false, itemStatus, ''); \n    \t        invoiceItemTotal += parseFloat(orderItem.ItemPrice*orderItem.ItemQuantity);\n    \t        invoiceShippingTotal += parseFloat(orderItem.ItemShipping);\n    \t        invoiceTaxTotal += parseFloat(orderItem.ItemTax);\n    \t        writeShippingAndTotal = true; \n    \t    } \n      \n            if (writeShippingAndTotal) {\n                // add shipping line\n                if (ICT.DBL(invoiceShippingTotal) > 0) {\n                    addItem(order, 'I', '03', '', 0, ICT.CUR(invoiceShippingTotal), '0', false, '0', '');\n                }\n                // add record total\n                addItem(order, 'I', '04', '', 0, ICT.CUR(parseFloat(invoiceItemTotal)+parseFloat(invoiceShippingTotal)), ICT.CUR(invoiceTaxTotal), false, '0', '');  \t  \n            } \n        } catch (err) {\n            var errMessage = 'An error occurred while trying to process order: ' +\n                order.OrderNumber + ' in file: ' + dict.get(\"OrderFile_ORIG_FILE_NAME_\") +\n                ' Exception: ' + err;\n            if (err instanceof java.io.IOException) {\n                ICT.TASK_ERROR('MMS -> Timeout processing order.', errMessage);\n            } else {\n                dict.put(ICT.NODE_NO_DELETE, true);\n                ICT.TASK_ERROR('MMS -> Error processing order.', errMessage);\n            }            \n        }\n    } \n}\n  \nif (orderCredits.containsKey(order.OrderNumber)) {\n\tvar orderCreditList = orderCredits[order.OrderNumber];\n\tfor (var c=0;c<orderCreditList.length;c++) {\n\t    var orderCredit = orderCreditList[c];\n\t    if (orderCredit.CreditType == 'S' && ICT.DBL(orderCredit.CreditAmount) > 0) {\n\t        // Shipping Credit\n\t        addItem(order, 'C', '05', '', 0, (orderCredit.CreditAmount * -1).toFixed(2), '0', false, '0', orderCredit.CreditReason);\n\t        addItem(order, 'C', '04', '', 0, (orderCredit.CreditAmount * -1).toFixed(2), '0', false, '0', '');\t      \n\t    } else if (orderCredit.CreditType == 'I') {\n\t        var creditItem = itemCacheMap.get(orderCredit.ItemId);\n\t        // Return\n\t        addItem(order, 'C', '07', creditItem.ProductPartNo, creditItem.Quantity * -1, (orderCredit.CreditAmount * -1).toFixed(2), '0', false, '0', '');\n\t        creditTotal += ICT.CUR(orderCredit.CreditAmount);\n\t    } else if (orderCredit.CreditType == 'T' && ICT.DBL(orderCredit.CreditAmount) > 0) {\n\t        // Tax Credit\n\t        addItem(order, 'C', '07', '', -1, '0', ICT.CUR(orderCredit.CreditAmount * -1), false, '0', '');\n\t        creditTotal += ICT.CUR(orderCredit.CreditAmount);\n\t    }\n\t}\n}\t  \n\nif (creditTotal > 0) {\n    addItem(order, 'C', '04', '', 0, (creditTotal * -1).toFixed(2), '0', false, '0', '');\t      \n}\n\nroot.put('PreProcessed', invoices);\n\ndict.put('Root', root);\n\nfunction addItem(order, invoiceType, recordType, sku, qty, amount, tax, isGiftCard, itemStatus, chargeCode) {\n    if (inDebug) {\n        print('addItem('+JSON.stringify(order)+','+invoiceType+','+recordType+','+\n            sku+','+qty+','+amount+','+tax+','+isGiftCard+','+itemStatus+','+chargeCode+')');\n    }\n    var record = new java.util.HashMap();\n    var parts = order.OrderAffiliateGroup.split('-');\n    record.put('Location', parts[0].trim());\n    record.put('ItemStatusId', itemStatus);\n    record.put('InvoiceNumber', order.OrderNumber);\n    record.put('InvoiceType', invoiceType);\n    record.put('RecordType', recordType);\n    record.put('Sequence', seq++);\n\n    record.put('CustomerNumber', order.OrderCustomer.CustomerID);\n    var orderDatePart = order.OrderDate.split('T');\n    record.put('InvoiceDate', orderDatePart[0].replaceAll('-', ''));\n    record.put('Sku', sku);\n    record.put('QuantityShipped', qty);\n    if (recordType == '01') {\n        record.put('DollarAmount', ICT.CUR(amount*qty));\n    } else {\n\t    record.put('DollarAmount', amount);\n    }\n    record.put('TaxAmount', tax);\n    if (chargeCode != undefined) {\n\t    record.put('AdditionalChargeCode', chargeCode);\n    } else {\n        record.put('AdditionalChargeCode', '');\n    }\n    if (recordType == '04') {\n        record.put('PayType', isGiftCard ? '10' : getPaymentType(order));\n    } else {\n        record.put('PayType', '0');\n    }\n    if ('OrderCouponName' in order) {\n        record.put('PromotionCode', order.OrderCouponName);\n    } else {\n        record.put('PromotionCode', '');\n    }\n    record.put('ReturnToStock', '');\n    invoices.add(record);\n    if (inDebug) {\n        print('addItem return null');\n    }\n}   \n\nfunction getOrderCredits(shipDate) {\n    if (inDebug) {\n        print('getOrderCredits('+shipDate+')');\n    }\n\n    var url = '!{AptosHost}/OrderService.asmx/GetOrderCredits?ClientName=!{AptosClientName}&Guid=!{AptosGUID}';\n    \n    var params = {};\n    params['Content-Type'] = 'text/xml';\n    var resp = ICT.REST.GET(url, params);\n\n    var retMap = new java.util.HashMap();\n\n    var doc = ICT.XML.DOC(resp);\n\n    var xPathFactory = javax.xml.xpath.XPathFactory.newInstance();\n    var xpath = xPathFactory.newXPath();\n    var xpathExpression = xpath.compile('/OrderCredits/OrderCredit');\n    var nodeList = xpathExpression.evaluate(doc, javax.xml.xpath.XPathConstants.NODESET);\n    for (var i=0;i<nodeList.getLength();i++) {\n        var orderCreditNode = nodeList.item(i);\n        if (orderCreditNode.getNodeType() == org.w3c.dom.Node.ELEMENT_NODE) {\n            var creditDate = orderCreditNode.getElementsByTagName('CreditDate').item(0).getTextContent();\n\t        var parts = creditDate.split('T');\n\t        if (parts.length > 1) {\n\t\t        creditDate = parts[0].replaceAll('\\\\-', '');\n\t\t        if (creditDate.equalsIgnoreCase(shipDate)) {\n\t                var creditType = orderCreditNode.getElementsByTagName('CreditType').item(0).getTextContent();\n    \t            var creditAmount = orderCreditNode.getElementsByTagName('CreditAmount').item(0).getTextContent();\n      \t            var creditReason = orderCreditNode.getElementsByTagName('CreditReason').item(0).getTextContent();\n      \t            var orderNo = orderCreditNode.getElementsByTagName('OrderNumber').item(0).getTextContent();\n      \t            var itemId = orderCreditNode.getElementsByTagName('ItemID').item(0).getTextContent();\n      \t  \n      \t            if ('S'.equalsIgnoreCase(creditType)) {\n      \t                creditReason = 'F';\n      \t            } else {\n      \t                creditReason = creditReasonMap[creditReason];\n      \t            } \n      \t            var orderCredit = {\n      \t                \"CreditType\": creditType,\n      \t                \"CreditAmount\": creditAmount,\n      \t                \"CreditReason\": creditReason,\n      \t                \"ItemId\": itemId\n      \t            };\t      \n\t                if (retMap.containsKey(orderNo)) {\n\t                    var list = retMap.get(orderNo);\n\t                    list.add(orderCredit);\n\t                } else {\n\t                    var list = new java.util.ArrayList();\n\t                    list.add(orderCredit);\n\t                    retMap.put(orderNo, list);\n\t                }\n\t            }\n            }\n        }\n    }\n    if (inDebug) {\n        print('getOrderCredits return -> ' + JSON.stringify(retMap));\n    }\n    return retMap;\n}\n\nfunction getPaymentType(order) {\n    if (inDebug) {\n        print('getPaymentType('+JSON.stringify(order)+')');\n    }\n    var paymentType = order.OrderPaymentType;\n    var cardType = order.OrderCardType;\n    var retVal = '';\n  \n    if (paymentType == 'Credit Card') {\n        if (cardType == 'Visa') {\n  \t        retVal = 4;\n        } else if (cardType == 'Amex') {\n  \t        retVal = 3;\n        } else if (cardType == 'MasterCard') {\n  \t        retVal = 5;\n        }\n    } else if (paymentType == 'Corporate Purchase Order') {\n  \t    retVal = 7;\n    } else if (paymentType == 'Cash, Check, Wire or Money Order') {\n        retVal = 1;\n    }\n    if (inDebug) {\n        print('getPaymentType return ' + retVal);\n    }\n    return retVal;\n}\n",
      "desc" : "Script to execute",
      "name" : "script",
      "valueType" : 2,
      "secret" : false,
      "refId" : "61734d1c-1ff6-4a2b-a251-00f3bd76b9ed"
    } ],
    "job" : {
      "id" : "8973e200-1f92-4301-a004-35a270f2cd15",
      "name" : "MMS - APTOS to MMS daily sales file",
      "lastRun" : [ 2017, 5, 17, 19, 51, 5 ],
      "enabled" : true,
      "desc" : "MMS - APTOS to MMS daily sales file",
      "status" : "READY",
      "snsARN" : "arn:aws:sns:us-east-1:194810246581:THEMET_Job_8973e200-1f92-4301-a004-35a270f2cd15",
      "key" : "MET-00000001",
      "environment" : "STAGING"
    },
    "name" : "Script Task",
    "key" : "Core::ScriptTask",
    "comment" : "Execute business rule and prepare data for template",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.ScriptTask",
    "enabled" : true,
    "desc" : "Task used to execute custom javascript",
    "refId" : "f5d44f40-cbd4-45fa-b45f-b062e546ad0f",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "9b77e739-63d5-45d2-b5e6-ee48755608e8",
    "ordinal" : 5,
    "taskParameters" : [ {
      "id" : "3f5e86a1-4892-4f2e-8524-a01998b26e01",
      "ordinal" : 1,
      "value" : "Root",
      "desc" : "Key name of input ",
      "name" : "inputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "e2963db8-9c7d-4863-b1ec-7a1bf15dbd52"
    }, {
      "id" : "5c151f70-8146-461d-9e4b-a0ee8b014b35",
      "ordinal" : 2,
      "value" : "<#compress>\n  <#list PreProcessed as item>\n    <#if item.RecordType != '99'>\n      ${item.Location + \"|\" + item.InvoiceNumber + \"|\" + item.InvoiceType + \"|\" + \n        item.RecordType + \"|\" + item.Sequence + \"|\" + item.CustomerNumber + \"|\" + item.InvoiceDate +\n        \"|\" + item.Sku + \"|\" + item.QuantityShipped + \"|\" + item.DollarAmount + \"|\" + item.TaxAmount + \n        \"|\" + item.AdditionalChargeCode + \"|\" + item.PayType + \"|\" + item.PromotionCode + \n        \"|\" + item.ReturnToStock}\n    </#if>\n  </#list>\n</#compress>",
      "desc" : "Template to use",
      "name" : "template",
      "valueType" : 2,
      "secret" : false,
      "refId" : "ed2bc33b-2474-4c9f-a7bb-80183abe53cf"
    }, {
      "id" : "0a0c5e9f-b3e8-4fde-b785-42d87f3481ff",
      "ordinal" : 3,
      "value" : "Invoices",
      "desc" : "Key name of output ",
      "name" : "outputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "be1f40ef-6389-4aa3-9124-4231b715107a"
    } ],
    "job" : {
      "id" : "8973e200-1f92-4301-a004-35a270f2cd15",
      "name" : "MMS - APTOS to MMS daily sales file",
      "lastRun" : [ 2017, 5, 17, 19, 51, 5 ],
      "enabled" : true,
      "desc" : "MMS - APTOS to MMS daily sales file",
      "status" : "READY",
      "snsARN" : "arn:aws:sns:us-east-1:194810246581:THEMET_Job_8973e200-1f92-4301-a004-35a270f2cd15",
      "key" : "MET-00000001",
      "environment" : "STAGING"
    },
    "name" : "Freemarker Execute Task",
    "key" : "Core::FreemarkerExecuteTask",
    "comment" : "Create Sales Order file",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.FreemarkerExecuteTask",
    "enabled" : true,
    "desc" : "Task used to execute Freemarker template.",
    "refId" : "edb872f0-243b-46ea-9149-ca967fe766e7",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "d271f714-942f-4d95-ba9d-e6bbdb920707",
    "ordinal" : 6,
    "taskParameters" : [ {
      "id" : "80d7a7e5-befa-4626-b828-63631de5c7b2",
      "ordinal" : 1,
      "value" : "Root",
      "desc" : "Key name of input ",
      "name" : "inputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "e2963db8-9c7d-4863-b1ec-7a1bf15dbd52"
    }, {
      "id" : "93449f6a-f769-46cf-98f5-70d2a0e63076",
      "ordinal" : 2,
      "value" : "<#compress>\n  <#list PreProcessed as item>\n    <#if item.RecordType == '99'>\n      ${item.Location + \"|\" + item.InvoiceNumber + \"|\" + item.Sku + \"|\" + item.QuantityShipped}\n    </#if>\n  </#list>\n</#compress>",
      "desc" : "Template to use",
      "name" : "template",
      "valueType" : 2,
      "secret" : false,
      "refId" : "ed2bc33b-2474-4c9f-a7bb-80183abe53cf"
    }, {
      "id" : "8a179f25-1467-4f8e-b2a0-7d4257035c9e",
      "ordinal" : 3,
      "value" : "ReserveInventory",
      "desc" : "Key name of output ",
      "name" : "outputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "be1f40ef-6389-4aa3-9124-4231b715107a"
    } ],
    "job" : {
      "id" : "8973e200-1f92-4301-a004-35a270f2cd15",
      "name" : "MMS - APTOS to MMS daily sales file",
      "lastRun" : [ 2017, 5, 17, 19, 51, 5 ],
      "enabled" : true,
      "desc" : "MMS - APTOS to MMS daily sales file",
      "status" : "READY",
      "snsARN" : "arn:aws:sns:us-east-1:194810246581:THEMET_Job_8973e200-1f92-4301-a004-35a270f2cd15",
      "key" : "MET-00000001",
      "environment" : "STAGING"
    },
    "name" : "Freemarker Execute Task",
    "key" : "Core::FreemarkerExecuteTask",
    "comment" : "Create Reserve Inventory File",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.FreemarkerExecuteTask",
    "enabled" : true,
    "desc" : "Task used to execute Freemarker template.",
    "refId" : "edb872f0-243b-46ea-9149-ca967fe766e7",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "797d4dc5-19cc-41ff-9f3e-e871865173f3",
    "ordinal" : 7,
    "taskParameters" : [ {
      "id" : "f6a1e4f6-684d-4482-bd04-22929560b5b9",
      "ordinal" : 1,
      "value" : "InvoicesFileName",
      "desc" : "Left Hand Parameter (left of equal)",
      "name" : "leftParam",
      "valueType" : 0,
      "secret" : false,
      "refId" : "872220ae-b87f-4ee4-8f74-b818960e521f"
    }, {
      "id" : "3987cbf3-e114-4d49-b8aa-c3930cf9e246",
      "ordinal" : 2,
      "value" : "${\n  var sdf = new java.text.SimpleDateFormat(\"yyyyMMdd'_'HHmmss\");\n  \"SalesToMMS_\" + sdf.format(new java.util.Date()) + \".csv\";\n}",
      "desc" : "Right Hand Parameter (right of equal)  Can contain ${} that contains javascript",
      "name" : "rightParam",
      "valueType" : 2,
      "secret" : false,
      "refId" : "983f881a-9f10-43cc-9850-e913d2ad530a"
    } ],
    "job" : {
      "id" : "8973e200-1f92-4301-a004-35a270f2cd15",
      "name" : "MMS - APTOS to MMS daily sales file",
      "lastRun" : [ 2017, 5, 17, 19, 51, 5 ],
      "enabled" : true,
      "desc" : "MMS - APTOS to MMS daily sales file",
      "status" : "READY",
      "snsARN" : "arn:aws:sns:us-east-1:194810246581:THEMET_Job_8973e200-1f92-4301-a004-35a270f2cd15",
      "key" : "MET-00000001",
      "environment" : "STAGING"
    },
    "name" : "Assign Task",
    "key" : "Core::AssignTask",
    "comment" : "Create SalesToMMS file name for use in Upload",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.AssignTask",
    "enabled" : true,
    "desc" : "Task used to Assign one key to another in the parameter dictionary",
    "refId" : "f749f807-bc45-4213-8db8-e66a8f263f44",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "44697500-e3ff-48f0-9e91-832dac959777",
    "ordinal" : 8,
    "taskParameters" : [ {
      "id" : "7154026b-ec1e-434d-a949-3233ee7cd2a7",
      "ordinal" : 1,
      "value" : "ReserveInventoryFileName",
      "desc" : "Left Hand Parameter (left of equal)",
      "name" : "leftParam",
      "valueType" : 0,
      "secret" : false,
      "refId" : "872220ae-b87f-4ee4-8f74-b818960e521f"
    }, {
      "id" : "678da79a-18a6-40fd-9328-e5982e9a57eb",
      "ordinal" : 2,
      "value" : "${\n  var sdf = new java.text.SimpleDateFormat(\"yyyyMMdd'_'HHmmss\");\n  \"ReservationToMMS_\" + sdf.format(new java.util.Date()) + \".csv\";\n}",
      "desc" : "Right Hand Parameter (right of equal)  Can contain ${} that contains javascript",
      "name" : "rightParam",
      "valueType" : 2,
      "secret" : false,
      "refId" : "983f881a-9f10-43cc-9850-e913d2ad530a"
    } ],
    "job" : {
      "id" : "8973e200-1f92-4301-a004-35a270f2cd15",
      "name" : "MMS - APTOS to MMS daily sales file",
      "lastRun" : [ 2017, 5, 17, 19, 51, 5 ],
      "enabled" : true,
      "desc" : "MMS - APTOS to MMS daily sales file",
      "status" : "READY",
      "snsARN" : "arn:aws:sns:us-east-1:194810246581:THEMET_Job_8973e200-1f92-4301-a004-35a270f2cd15",
      "key" : "MET-00000001",
      "environment" : "STAGING"
    },
    "name" : "Assign Task",
    "key" : "Core::AssignTask",
    "comment" : "Create ReservationToMMS filename for use in upload",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.AssignTask",
    "enabled" : true,
    "desc" : "Task used to Assign one key to another in the parameter dictionary",
    "refId" : "f749f807-bc45-4213-8db8-e66a8f263f44",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "fdb6d5b7-f478-4a24-9d2d-4ccb309c5d1a",
    "ordinal" : 9,
    "taskParameters" : [ {
      "id" : "0c71bc0e-a783-4e57-bf00-029660287b76",
      "ordinal" : 1,
      "value" : "!{ftpuser}",
      "desc" : "User to login to ftp",
      "name" : "user",
      "valueType" : 0,
      "secret" : false,
      "refId" : "a68a11c6-cef6-4408-85f5-4f0728e8e3c7"
    }, {
      "id" : "bc9a1811-24ff-45d2-84b8-8790c347ee17",
      "ordinal" : 2,
      "value" : "BXXINgqvppOr17T72uw7VQ==",
      "desc" : "Password to login to ftp",
      "name" : "password",
      "valueType" : 0,
      "secret" : true,
      "refId" : "a34fea04-c5b1-442c-975e-1655184f32f3"
    }, {
      "id" : "6e37fac6-fdec-47bc-8978-b99fbb92c8a1",
      "ordinal" : 3,
      "value" : "!{ftpurl}/output/sales/${InvoicesFileName}",
      "desc" : "Url to file",
      "name" : "url",
      "valueType" : 0,
      "secret" : false,
      "refId" : "b102d706-66ce-4d8b-8944-ec8ba327b7b2"
    }, {
      "id" : "b80b921b-738d-47a9-9086-e29678f90a2f",
      "ordinal" : 4,
      "value" : "Invoices",
      "desc" : "Key name of input file",
      "name" : "inputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "06532b8a-daf2-457c-8c65-701e9cc0ec01"
    } ],
    "job" : {
      "id" : "8973e200-1f92-4301-a004-35a270f2cd15",
      "name" : "MMS - APTOS to MMS daily sales file",
      "lastRun" : [ 2017, 5, 17, 19, 51, 5 ],
      "enabled" : true,
      "desc" : "MMS - APTOS to MMS daily sales file",
      "status" : "READY",
      "snsARN" : "arn:aws:sns:us-east-1:194810246581:THEMET_Job_8973e200-1f92-4301-a004-35a270f2cd15",
      "key" : "MET-00000001",
      "environment" : "STAGING"
    },
    "name" : "Upload File from Map",
    "key" : "Core::UploadFileFromMapTask",
    "comment" : "Upload SalesOrder file",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.UploadFileFromMapTask",
    "enabled" : true,
    "desc" : "Task used to upload a file to ftp, sftp, ftps, local or webdav from a map.",
    "refId" : "fb285dc7-59db-4382-b004-df6ee6147084",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "3887b571-8169-4f74-873f-e5eaa86d438f",
    "ordinal" : 10,
    "taskParameters" : [ {
      "id" : "25262e0a-47fd-4eb4-a9a3-fb8a3863d7a9",
      "ordinal" : 1,
      "value" : "!{ftpuser}",
      "desc" : "User to login to ftp",
      "name" : "user",
      "valueType" : 0,
      "secret" : false,
      "refId" : "a68a11c6-cef6-4408-85f5-4f0728e8e3c7"
    }, {
      "id" : "218b7cb5-3bf4-4f8e-be51-b3d88fc24cdb",
      "ordinal" : 2,
      "value" : "BXXINgqvppOr17T72uw7VQ==",
      "desc" : "Password to login to ftp",
      "name" : "password",
      "valueType" : 0,
      "secret" : true,
      "refId" : "a34fea04-c5b1-442c-975e-1655184f32f3"
    }, {
      "id" : "acc3f1df-9f16-4ddd-8d0a-22fc1836243c",
      "ordinal" : 3,
      "value" : "!{ftpurl}/output/reservation/${ReserveInventoryFileName}",
      "desc" : "Url to file",
      "name" : "url",
      "valueType" : 0,
      "secret" : false,
      "refId" : "b102d706-66ce-4d8b-8944-ec8ba327b7b2"
    }, {
      "id" : "3376dec2-1fa5-4a5f-9f37-c0b0d0f2ec1a",
      "ordinal" : 4,
      "value" : "ReserveInventory",
      "desc" : "Key name of input file",
      "name" : "inputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "06532b8a-daf2-457c-8c65-701e9cc0ec01"
    } ],
    "job" : {
      "id" : "8973e200-1f92-4301-a004-35a270f2cd15",
      "name" : "MMS - APTOS to MMS daily sales file",
      "lastRun" : [ 2017, 5, 17, 19, 51, 5 ],
      "enabled" : true,
      "desc" : "MMS - APTOS to MMS daily sales file",
      "status" : "READY",
      "snsARN" : "arn:aws:sns:us-east-1:194810246581:THEMET_Job_8973e200-1f92-4301-a004-35a270f2cd15",
      "key" : "MET-00000001",
      "environment" : "STAGING"
    },
    "name" : "Upload File from Map",
    "key" : "Core::UploadFileFromMapTask",
    "comment" : "Upload Reserve Inventory file",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.UploadFileFromMapTask",
    "enabled" : true,
    "desc" : "Task used to upload a file to ftp, sftp, ftps, local or webdav from a map.",
    "refId" : "fb285dc7-59db-4382-b004-df6ee6147084",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "6a4ce4c5-e2a4-4de9-91ef-db6f8e235e28",
    "ordinal" : 11,
    "taskParameters" : [ {
      "id" : "394c7441-2671-46ba-976c-636f563175d0",
      "ordinal" : 1,
      "value" : "!{ftpuser}",
      "desc" : "User to login to ftp",
      "name" : "user",
      "valueType" : 0,
      "secret" : false,
      "refId" : "a68a11c6-cef6-4408-85f5-4f0728e8e3c7"
    }, {
      "id" : "126b9b91-9e1d-4cdb-9527-5bdbb52aab42",
      "ordinal" : 2,
      "value" : "BXXINgqvppOr17T72uw7VQ==",
      "desc" : "Password to login to ftp",
      "name" : "password",
      "valueType" : 0,
      "secret" : true,
      "refId" : "a34fea04-c5b1-442c-975e-1655184f32f3"
    }, {
      "id" : "6d757272-254d-4623-989e-8bc077abfaf3",
      "ordinal" : 3,
      "value" : "!{ftpurl}/output/sales/archive/${InvoicesFileName}",
      "desc" : "Url to file",
      "name" : "url",
      "valueType" : 0,
      "secret" : false,
      "refId" : "b102d706-66ce-4d8b-8944-ec8ba327b7b2"
    }, {
      "id" : "21d056bf-2d6f-458c-9b54-73ed06ba48f8",
      "ordinal" : 4,
      "value" : "Invoices",
      "desc" : "Key name of input file",
      "name" : "inputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "06532b8a-daf2-457c-8c65-701e9cc0ec01"
    } ],
    "job" : {
      "id" : "8973e200-1f92-4301-a004-35a270f2cd15",
      "name" : "MMS - APTOS to MMS daily sales file",
      "lastRun" : [ 2017, 5, 17, 19, 51, 5 ],
      "enabled" : true,
      "desc" : "MMS - APTOS to MMS daily sales file",
      "status" : "READY",
      "snsARN" : "arn:aws:sns:us-east-1:194810246581:THEMET_Job_8973e200-1f92-4301-a004-35a270f2cd15",
      "key" : "MET-00000001",
      "environment" : "STAGING"
    },
    "name" : "Upload File from Map",
    "key" : "Core::UploadFileFromMapTask",
    "comment" : "Upload Sales File to archive directory",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.UploadFileFromMapTask",
    "enabled" : true,
    "desc" : "Task used to upload a file to ftp, sftp, ftps, local or webdav from a map.",
    "refId" : "fb285dc7-59db-4382-b004-df6ee6147084",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "a2c8c2d4-44a9-4709-9e43-4464cb431868",
    "ordinal" : 12,
    "taskParameters" : [ {
      "id" : "b5b56dae-73f2-47e6-b2f6-b08e5dd2196e",
      "ordinal" : 1,
      "value" : "!{ftpuser}",
      "desc" : "User to login to ftp",
      "name" : "user",
      "valueType" : 0,
      "secret" : false,
      "refId" : "a68a11c6-cef6-4408-85f5-4f0728e8e3c7"
    }, {
      "id" : "52a413f4-e4f2-4d1a-85c5-dc17607d87b0",
      "ordinal" : 2,
      "value" : "BXXINgqvppOr17T72uw7VQ==",
      "desc" : "Password to login to ftp",
      "name" : "password",
      "valueType" : 0,
      "secret" : true,
      "refId" : "a34fea04-c5b1-442c-975e-1655184f32f3"
    }, {
      "id" : "e234b876-6a7c-4b32-bfb9-f3e0174c58a0",
      "ordinal" : 3,
      "value" : "!{ftpurl}/output/reservation/archive/${ReserveInventoryFileName}",
      "desc" : "Url to file",
      "name" : "url",
      "valueType" : 0,
      "secret" : false,
      "refId" : "b102d706-66ce-4d8b-8944-ec8ba327b7b2"
    }, {
      "id" : "171d7d72-a9b2-4b91-89a5-bc0ddb9c9c3b",
      "ordinal" : 4,
      "value" : "ReserveInventory",
      "desc" : "Key name of input file",
      "name" : "inputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "06532b8a-daf2-457c-8c65-701e9cc0ec01"
    } ],
    "job" : {
      "id" : "8973e200-1f92-4301-a004-35a270f2cd15",
      "name" : "MMS - APTOS to MMS daily sales file",
      "lastRun" : [ 2017, 5, 17, 19, 51, 5 ],
      "enabled" : true,
      "desc" : "MMS - APTOS to MMS daily sales file",
      "status" : "READY",
      "snsARN" : "arn:aws:sns:us-east-1:194810246581:THEMET_Job_8973e200-1f92-4301-a004-35a270f2cd15",
      "key" : "MET-00000001",
      "environment" : "STAGING"
    },
    "name" : "Upload File from Map",
    "key" : "Core::UploadFileFromMapTask",
    "comment" : "Upload Reserve Inventory file to Archive",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.UploadFileFromMapTask",
    "enabled" : true,
    "desc" : "Task used to upload a file to ftp, sftp, ftps, local or webdav from a map.",
    "refId" : "fb285dc7-59db-4382-b004-df6ee6147084",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  } ],
  "desc" : "MMS - APTOS to MMS daily sales file",
  "status" : "READY",
  "snsARN" : "arn:aws:sns:us-east-1:194810246581:THEMET_Job_8973e200-1f92-4301-a004-35a270f2cd15",
  "key" : "MET-00000001",
  "environment" : "STAGING"
}